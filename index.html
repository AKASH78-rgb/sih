<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Attendance & Activity App</title>
    <link rel="stylesheet" href="styles.css">
    
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <h1>📚 Smart Attendance System</h1>
            <h3>Punjab Higher Education Initiative</h3>
            <div class="login-form">
                <input type="text" id="userId" placeholder="Enter User ID">
                <input type="password" id="password" placeholder="Enter Password">
                <select id="userRole" title="Select User Role">
                    <option value="student">Student</option>
                    <option value="teacher">Teacher</option>
                </select>
                <button onclick="login()">Login</button>
                <p class="hint">Demo: Use any ID/password to login</p>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="screen">
        <nav class="navbar">
            <h2>Student Portal</h2>
            <span id="studentName"></span>
            <span id="dateTime" style="margin-left: auto; font-size: 14px; align-self: center;"></span>
            <button onclick="logout()">Logout</button>
        </nav>
        
        <div class="dashboard-container">
            <!-- Student Profile Card -->
            <div class="card">
                <h3 class="card-title-small">👤 Student Profile</h3>
                <div id="studentProfile">
                    <!-- Profile will be loaded here -->
                </div>
            </div>
            
            <!-- Today's Schedule -->
            <div class="card">
                <h3>📅 Today's Schedule</h3>
                <div id="scheduleList" class="schedule-list"></div>
            </div>

            <!-- QR Scanner for Attendance -->
            <div class="card">
                <h3>📸 Mark Attendance</h3>
                <div class="qr-scanner">
                    <!-- Status messages -->
                    <div id="attendance-status" style="margin-bottom: 15px; padding: 10px; border-radius: 6px; display: none;"></div>
                    
                    <!-- Subject selection area -->
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Select Subject:</label>
                        
                        <!-- Camera display area - shows right below subject line -->
                        <div id="scanner-container" style="display: none; text-align: center; background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 15px; border: 2px solid #4caf50;">
                            <!-- Camera feed and controls will be inserted here by JavaScript -->
                        </div>
                        
                        <!-- Manual input field -->
                        <input type="text" id="qrCodeInput" placeholder="Enter class code (e.g., CN, TOC, FM, LAB)" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; text-align: center; margin-bottom: 10px;">
                    </div>
                    
                    <!-- Action buttons -->
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button onclick="markAttendance()" style="flex: 1; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            ✓ Mark Present
                        </button>
                        <button onclick="startQRScanner()" style="flex: 1; padding: 12px; background: #2196f3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            📷 Scan QR Code
                        </button>
                    </div>
                    
                </div>
                <div id="attendanceStatus"></div>
            </div>

            <!-- Productivity Tracker -->
            <div class="card">
                <h3 class="card-title-small">📊 Productivity Tracker</h3>
                <div id="productivityTracker">
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <div style="font-size: 24px; margin-bottom: 10px;">📊</div>
                        <div>Loading productivity data...</div>
                    </div>
                </div>
            </div>
            
            <!-- Free Period Activities -->
            <div class="card">
                <h3 class="card-title-small">🎯 Recommended Activities</h3>
                
                <!-- Quiz Box - Files from Quiz Folder -->
                <div id="quizSection" class="quiz-section">
                    <h4 class="quiz-section-title">📝 Quizzes</h4>
                    <ul id="quizList">
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #2196f3;">
                            <a href="quiz/fundamentalManagementQuiz.html" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: 500;">📊 Fundamental Management Quiz</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #2196f3;">
                            <a href="quiz/computerNetworksQuiz.html" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: 500;">🌐 Computer Networks Quiz</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #2196f3;">
                            <a href="quiz/marketingManagementQuiz.html" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: 500;">📈 Marketing Management Quiz</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #2196f3;">
                            <a href="quiz/researchMethodologyAndIPRQuiz.html" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: 500;">🔬 Research Methodology and IPR Quiz</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #2196f3;">
                            <a href="quiz/aiMlResearchPapers.html" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: 500;">🤖 AI/ML Research Papers</a>
                        </li>
                    </ul>
                </div>

                <!-- Explore More Box - Files from Explore_More Folder -->
                <div id="linkedActivitiesSection" class="quiz-section">
                    <h4 class="quiz-section-title">🔗 Explore More</h4>
                    <ul id="linkedActivitiesList">
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #4caf50;">
                            <a href="explore_more/pythonProgramming.html" target="_blank" style="text-decoration: none; color: #4caf50; font-weight: 500;">🐍 Python Programming Practice</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #4caf50;">
                            <a href="explore_more/careerPlanning.html" target="_blank" style="text-decoration: none; color: #4caf50; font-weight: 500;">🎯 Career Planning Workshop</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #4caf50;">
                            <a href="explore_more/mathProblemSolving.html" target="_blank" style="text-decoration: none; color: #4caf50; font-weight: 500;">🧮 Math Problem Solving</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #4caf50;">
                            <a href="explore_more/projectBrainstorming.html" target="_blank" style="text-decoration: none; color: #4caf50; font-weight: 500;">💡 Project Brainstorming</a>
                        </li>
                        <li style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #4caf50;">
                            <a href="explore_more/physicalActivity.html" target="_blank" style="text-decoration: none; color: #4caf50; font-weight: 500;">🏃 Physical Activity Guide</a>
                        </li>
                    </ul>
                </div>

            </div>

            <!-- Attendance History -->
            <div class="card">
                <h3>📊 Your Attendance</h3>
                <div id="attendanceHistory">
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <div style="font-size: 24px; margin-bottom: 10px;">📊</div>
                        <div>Loading attendance history...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Teacher Dashboard -->
    <div id="teacherDashboard" class="screen">
        <nav class="navbar">
            <h2>Teacher Portal</h2>
            <span id="teacherName"></span>
            <button onclick="logout()">Logout</button>
        </nav>
        
        <div class="dashboard-container">
            <!-- Generate QR for Class -->
            <div class="card">
                <h3>🔑 Generate Attendance QR</h3>
                <select id="classSelect" title="Select Class">
                    <option value="">Select Class</option>
                    <option value="CS101">CS101 - Computer Science</option>
                    <option value="MATH201">MATH201 - Mathematics</option>
                    <option value="PHY301">PHY301 - Physics</option>
                    <option value="ENG101">ENG101 - English</option>
                </select>
                <button onclick="generateQR()">Generate QR Code</button>
                <button onclick="testQRLibrary()" class="test-qr-button">Test QR Library</button>
                <div id="qrDisplay"></div>
            </div>

            <!-- View Attendance -->
            <div class="card">
                <h3>📋 Class Attendance</h3>
                <div id="classAttendanceView"></div>
            </div>

            <!-- Today's Classes -->
            <div class="card">
                <h3>📚 Your Classes Today</h3>
                <div id="teacherSchedule"></div>
            </div>

            <!-- Recommended Schedule (by Subject) -->
            <div class="card" id="teacherRecCard">
                <h3>🧭 Recommended Schedule</h3>
                <div id="teacherRecDayLabel" style="margin: 6px 0 12px; color:#555; font-weight:600;"></div>

                <div style="display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-bottom:10px;">
                    <label for="teacherDayPicker" style="font-weight:600;">Day:</label>
                    <select id="teacherDayPicker" title="Select Day" style="min-width:140px;">
                        <option value="TODAY">Today</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                    </select>
                    <label for="teacherSubjectPicker" style="font-weight:600;">Subject:</label>
                    <select id="teacherSubjectPicker" title="Select Subject" style="min-width:200px;"></select>

                    <label for="teacherTypeFilter" style="font-weight:600;">Type:</label>
                    <select id="teacherTypeFilter" title="Filter by type" style="min-width:160px;">
                        <option value="">All</option>
                        <option value="LECTURE">Lecture</option>
                        <option value="LAB">Lab</option>
                        <option value="BREAK">Break/Lunch</option>
                    </select>

                    <label style="display:flex; align-items:center; gap:6px; margin-left:auto;">
                        <input type="checkbox" id="teacherUpcomingOnly"> Upcoming only
                    </label>
                </div>

                <div id="teacherRecSummary" style="margin-bottom:8px; color:#444; font-size: 14px;"></div>
                <div style="margin-bottom:8px; color:#666; font-size:12px; display:flex; gap:12px; flex-wrap:wrap;">
                    <span><span style="display:inline-block; width:10px; height:10px; background:#e3f2fd; border:1px solid #90caf9; margin-right:6px;"></span>Lecture</span>
                    <span><span style="display:inline-block; width:10px; height:10px; background:#e8f5e9; border:1px solid #81c784; margin-right:6px;"></span>Lab</span>
                    <span><span style="display:inline-block; width:10px; height:10px; background:#fff3e0; border:1px solid #ffb74d; margin-right:6px;"></span>Break/Lunch</span>
                    <span><span style="display:inline-block; width:10px; height:10px; background:#ede7f6; border:1px solid #b39ddb; margin-right:6px;"></span>Current</span>
                </div>

                <div id="teacherRecommendedSchedule"></div>

                <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:10px;">
                    <button id="teacherRecCopyBtn">Copy</button>
                    <button id="teacherRecCsvBtn">Export CSV</button>
                    <button id="teacherRecPrintBtn">Print</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>

